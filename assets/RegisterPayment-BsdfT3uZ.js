import{az as G,at as r,aA as N,aB as K,o,c as p,k as i,z as n,a as d,v as u,w as c,j as v,N as y,A as g,K as x,O as k,aC as P}from"./index-Cj-k1PN7.js";import{b as U,c as $,f as D,I as O}from"./config-B2qi-ZB6.js";import{s as H,a as J}from"./index-hN2dFyDU.js";import{s as V}from"./index-B2sqpUK9.js";import{a as B}from"./index-DB_-vnPU.js";import"./index-CEaFRDN1.js";const Q={key:0,class:"card mt-10"},W={class:"flex flex-col items-center gap-4 mb-2"},X={class:"flex flex-col justify-center items-center"},Y={key:1,class:"card flex justify-center"},Z={class:"flex flex-col justify-center items-center gap-4 mb-2"},ee={class:"flex flex-col justify-center items-center gap-4 mb-2"},te={class:"flex flex-col justify-center items-center gap-4 mb-2"},ae={class:"flex flex-col justify-center items-center gap-4 mb-2"},se={class:"flex flex-col justify-center items-center gap-4 mb-2"},le={class:"flex flex-col justify-center items-center gap-4 mb-2"},me={__name:"RegisterPayment",setup(oe){const f=G(),j=r(!1),C=r(null),z=r(null),F=r([]),_=r([]),I=r([]),L=r([{desc:"Pago total"},{desc:"Pago parcial"},{desc:"Pago saldo"},{desc:"Pago retrasado"},{desc:"Pago pago adelantado"}]),w=r(!1),b=r(!1),h=r(!1),e=N({client:"",service:"",payment:"",amount:0,description:"Pago total"}),s=N({client:[],service:[],payment:[],amount:[],description:[]}),S=()=>{parseFloat(e.amount)<=0&&s.amount.push({type:"minimum",content:"Monto deberia ser menor a 0"}),parseFloat(e.amount)>9999999&&s.amount.push({type:"minimum",content:"Monto no deberia ser mayor a 9999999"}),e.client||s.client.push({type:"required",content:"Debe seleccionar un cliente"}),e.service||s.service.push({type:"required",content:"Debe seleccionar un servicio"}),e.payment||s.payment.push({type:"required",content:"Debe seleccionar un pago"});for(let l in s)if(s[l].length>0)return!1;return!0},q=()=>{for(let l in s)s[l]=[]},E=()=>{e.client="",e.service="",e.payment="",e.amount=0,e.description="Pago total"},M=async()=>{try{b.value=!0;const l=await D.listDocuments("672ad95700261cb70729","672ad9650023a7c2078e");F.value=l.documents,b.value=!1}catch(l){b.value=!1,console.log(l)}},T=async()=>{try{h.value=!0;const l=await D.listDocuments("672ad95700261cb70729","672ad9ea002421a0212f");_.value=l.documents,h.value=!1}catch(l){h.value=!1,console.log(l)}},A=()=>{q();const l=S();try{if(!l){f.add({severity:"warn",summary:"Datos Invalidos.",life:3e3});return}w.value=!0,D.createDocument("672ad95700261cb70729","672add8800111e03063a",O.unique(),{amount:parseFloat(e.amount),client:e.client,payment:e.payment}).then(function(t){w.value=!1,E(),f.add({severity:"success",summary:"Se guardo el pago exitosamente.",life:3e3})},function(t){w.value=!1,console.log(t),f.add({severity:"error",summary:"No se pudo guardar.",life:3e3})})}catch(a){console.log(a)}},R=()=>{if(C.value!=="marcelo@"){f.add({severity:"warn",summary:"Contraseña Inválida.",life:3e3});return}f.add({severity:"success",summary:"Contraseña Correcta.",life:3e3}),j.value=!0,M(),T()};return K(()=>e.service,l=>{if(l){const a=_.value.findIndex(t=>t.$id===l);a!==-1&&(I.value=_.value[a].payments,e.payment="")}}),(l,a)=>(o(),p(y,null,[i(n(H)),j.value?(o(),p("div",Y,[i(n(J),{style:{width:"25rem"}},{content:c(()=>[d("div",Z,[i(n($),{modelValue:e.client,"onUpdate:modelValue":a[1]||(a[1]=t=>e.client=t),options:F.value,optionLabel:"full_name",optionValue:"$id",placeholder:"Clientes",class:"w-full md:w-56",loading:b.value},null,8,["modelValue","options","loading"]),s.client.length>0?(o(),u(P,{key:0,name:"p-message",tag:"div",class:"flex flex-col"},{default:c(()=>[(o(!0),p(y,null,k(s.client,(t,m)=>(o(),u(n(V),{key:`error-client-${m}`,severity:"error",size:"small",variant:"simple"},{default:c(()=>[g(x(t.content),1)]),_:2},1024))),128))]),_:1})):v("",!0)]),d("div",ee,[i(n($),{modelValue:e.service,"onUpdate:modelValue":a[2]||(a[2]=t=>e.service=t),options:_.value,optionLabel:"title",optionValue:"$id",placeholder:"Servicios",class:"w-full md:w-56",loading:h.value},null,8,["modelValue","options","loading"]),s.service.length>0?(o(),u(P,{key:0,name:"p-message",tag:"div",class:"flex flex-col"},{default:c(()=>[(o(!0),p(y,null,k(s.service,(t,m)=>(o(),u(n(V),{key:`error-service-${m}`,severity:"error",size:"small",variant:"simple"},{default:c(()=>[g(x(t.content),1)]),_:2},1024))),128))]),_:1})):v("",!0)]),d("div",te,[i(n($),{modelValue:e.payment,"onUpdate:modelValue":a[3]||(a[3]=t=>e.payment=t),options:I.value,optionLabel:"title",optionValue:"$id",placeholder:"Pagos",class:"w-full md:w-56"},null,8,["modelValue","options"]),s.payment.length>0?(o(),u(P,{key:0,name:"p-message",tag:"div",class:"flex flex-col"},{default:c(()=>[(o(!0),p(y,null,k(s.payment,(t,m)=>(o(),u(n(V),{key:`error-payment-${m}`,severity:"error",size:"small",variant:"simple"},{default:c(()=>[g(x(t.content),1)]),_:2},1024))),128))]),_:1})):v("",!0)]),d("div",ae,[i(n(U),{modelValue:e.amount,"onUpdate:modelValue":a[4]||(a[4]=t=>e.amount=t),type:"number",placeholder:"Monto",class:"w-full sm:w-56"},null,8,["modelValue"]),s.amount.length>0?(o(),u(P,{key:0,name:"p-message",tag:"div",class:"flex flex-col"},{default:c(()=>[(o(!0),p(y,null,k(s.amount,(t,m)=>(o(),u(n(V),{key:`error-amount-${m}`,severity:"error",size:"small",variant:"simple"},{default:c(()=>[g(x(t.content),1)]),_:2},1024))),128))]),_:1})):v("",!0)]),d("div",se,[i(n($),{modelValue:e.description,"onUpdate:modelValue":a[5]||(a[5]=t=>e.description=t),options:L.value,optionLabel:"desc",optionValue:"desc",placeholder:"Descripción",class:"w-full md:w-56"},null,8,["modelValue","options"])]),d("div",le,[i(n(B),{loading:w.value,loadingIcon:"pi pi-spinner pi-spin",type:"submit",severity:"primary",label:"Registrar",class:"w-full sm:w-56",onClick:A},null,8,["loading"])])]),_:1})])):(o(),p("div",Q,[d("div",W,[i(n(U),{modelValue:C.value,"onUpdate:modelValue":a[0]||(a[0]=t=>C.value=t),placeholder:"Contraseña",class:"w-1/2"},null,8,["modelValue"]),z.value?(o(),u(n(V),{key:0,severity:"error",size:"small",variant:"simple"},{default:c(()=>[g(" * "+x(z.value),1)]),_:1})):v("",!0)]),d("div",X,[i(n(B),{severity:"primary",label:"Verificar",class:"w-1/2",onClick:R})])]))],64))}};export{me as default};
