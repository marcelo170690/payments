import{az as K,at as i,aA as S,aB as O,o,c as p,k as c,z as n,a as d,v as m,w as u,j as v,N as y,A as g,K as x,O as k,aC as P}from"./index-BgU04PQg.js";import{b as U,c as $,f as j,I as H}from"./config-Ck1cNADm.js";import{s as J,a as Q}from"./index-DcepLoJp.js";import{s as V}from"./index-Dc2BzITK.js";import{a as B}from"./index-JWPrD7GI.js";import"./index-BOmtySJb.js";const W={key:0,class:"card mt-10"},X={class:"flex flex-col items-center gap-4 mb-2"},Y={class:"flex flex-col justify-center items-center"},Z={key:1,class:"card flex justify-center"},ee={class:"flex flex-col justify-center items-center gap-4 mb-2"},te={class:"flex flex-col justify-center items-center gap-4 mb-2"},ae={class:"flex flex-col justify-center items-center gap-4 mb-2"},se={class:"flex flex-col justify-center items-center gap-4 mb-2"},le={class:"flex flex-col justify-center items-center gap-4 mb-2"},oe={class:"flex flex-col justify-center items-center gap-4 mb-2"},pe={__name:"RegisterPayment",setup(ne){const f=K(),z=i(!1),C=i(null),F=i(null),I=i([]),_=i([]),N=i([]),L=i([{desc:"Pago total"},{desc:"Pago parcial"},{desc:"Pago saldo"},{desc:"Pago retrasado"},{desc:"Pago pago adelantado"}]),w=i(!1),b=i(!1),h=i(!1),t=S({client:"",service:"",payment:"",amount:0,description:"Pago total"}),s=S({client:[],service:[],payment:[],amount:[],description:[]}),q=()=>{parseFloat(t.amount)<=0&&s.amount.push({type:"minimum",content:"Monto deberia ser menor a 0"}),parseFloat(t.amount)>9999999&&s.amount.push({type:"minimum",content:"Monto no deberia ser mayor a 9999999"}),t.client||s.client.push({type:"required",content:"Debe seleccionar un cliente"}),t.service||s.service.push({type:"required",content:"Debe seleccionar un servicio"}),t.payment||s.payment.push({type:"required",content:"Debe seleccionar un pago"});for(let l in s)if(s[l].length>0)return!1;return!0},E=()=>{for(let l in s)s[l]=[]},M=()=>{t.client="",t.service="",t.payment="",t.amount=0,t.description="Pago total"},T=async()=>{try{b.value=!0;const l=await j.listDocuments("672ad95700261cb70729","672ad9650023a7c2078e");I.value=l.documents,b.value=!1}catch(l){b.value=!1,console.log(l)}},A=async()=>{try{h.value=!0;const l=await j.listDocuments("672ad95700261cb70729","672ad9ea002421a0212f");_.value=l.documents,h.value=!1}catch(l){h.value=!1,console.log(l)}},R=()=>{E();const l=q();try{if(!l){f.add({severity:"warn",summary:"Datos Invalidos.",life:3e3});return}w.value=!0,j.createDocument("672ad95700261cb70729","672add8800111e03063a",H.unique(),{amount:parseFloat(t.amount),client:t.client,payment:t.payment}).then(function(e){w.value=!1,M(),f.add({severity:"success",summary:"Se guardo el pago exitosamente.",life:3e3})},function(e){w.value=!1,console.log(e),f.add({severity:"error",summary:"No se pudo guardar.",life:3e3})})}catch(a){console.log(a)}},G=()=>{if(C.value!=="marcelo@"){f.add({severity:"warn",summary:"Contraseña Inválida.",life:3e3});return}f.add({severity:"success",summary:"Contraseña Correcta.",life:3e3}),z.value=!0,T(),A()};return O(()=>t.service,l=>{if(l){const a=_.value.findIndex(e=>e.$id===l);if(a!==-1){let e=[..._.value[a].payments].map((r,D)=>({...r,num:D+1}));e.sort((r,D)=>D.num-r.num),N.value=e,t.payment=""}}}),(l,a)=>(o(),p(y,null,[c(n(J)),z.value?(o(),p("div",Z,[c(n(Q),{style:{width:"25rem"}},{content:u(()=>[d("div",ee,[c(n($),{modelValue:t.client,"onUpdate:modelValue":a[1]||(a[1]=e=>t.client=e),options:I.value,optionLabel:"full_name",optionValue:"$id",placeholder:"Clientes",class:"w-full md:w-56",loading:b.value},null,8,["modelValue","options","loading"]),s.client.length>0?(o(),m(P,{key:0,name:"p-message",tag:"div",class:"flex flex-col"},{default:u(()=>[(o(!0),p(y,null,k(s.client,(e,r)=>(o(),m(n(V),{key:`error-client-${r}`,severity:"error",size:"small",variant:"simple"},{default:u(()=>[g(x(e.content),1)]),_:2},1024))),128))]),_:1})):v("",!0)]),d("div",te,[c(n($),{modelValue:t.service,"onUpdate:modelValue":a[2]||(a[2]=e=>t.service=e),options:_.value,optionLabel:"title",optionValue:"$id",placeholder:"Servicios",class:"w-full md:w-56",loading:h.value},null,8,["modelValue","options","loading"]),s.service.length>0?(o(),m(P,{key:0,name:"p-message",tag:"div",class:"flex flex-col"},{default:u(()=>[(o(!0),p(y,null,k(s.service,(e,r)=>(o(),m(n(V),{key:`error-service-${r}`,severity:"error",size:"small",variant:"simple"},{default:u(()=>[g(x(e.content),1)]),_:2},1024))),128))]),_:1})):v("",!0)]),d("div",ae,[c(n($),{modelValue:t.payment,"onUpdate:modelValue":a[3]||(a[3]=e=>t.payment=e),options:N.value,optionLabel:"title",optionValue:"$id",placeholder:"Pagos",class:"w-full md:w-56"},null,8,["modelValue","options"]),s.payment.length>0?(o(),m(P,{key:0,name:"p-message",tag:"div",class:"flex flex-col"},{default:u(()=>[(o(!0),p(y,null,k(s.payment,(e,r)=>(o(),m(n(V),{key:`error-payment-${r}`,severity:"error",size:"small",variant:"simple"},{default:u(()=>[g(x(e.content),1)]),_:2},1024))),128))]),_:1})):v("",!0)]),d("div",se,[c(n(U),{modelValue:t.amount,"onUpdate:modelValue":a[4]||(a[4]=e=>t.amount=e),type:"number",placeholder:"Monto",class:"w-full sm:w-56"},null,8,["modelValue"]),s.amount.length>0?(o(),m(P,{key:0,name:"p-message",tag:"div",class:"flex flex-col"},{default:u(()=>[(o(!0),p(y,null,k(s.amount,(e,r)=>(o(),m(n(V),{key:`error-amount-${r}`,severity:"error",size:"small",variant:"simple"},{default:u(()=>[g(x(e.content),1)]),_:2},1024))),128))]),_:1})):v("",!0)]),d("div",le,[c(n($),{modelValue:t.description,"onUpdate:modelValue":a[5]||(a[5]=e=>t.description=e),options:L.value,optionLabel:"desc",optionValue:"desc",placeholder:"Descripción",class:"w-full md:w-56"},null,8,["modelValue","options"])]),d("div",oe,[c(n(B),{loading:w.value,loadingIcon:"pi pi-spinner pi-spin",type:"submit",severity:"primary",label:"Registrar",class:"w-full sm:w-56",onClick:R},null,8,["loading"])])]),_:1})])):(o(),p("div",W,[d("div",X,[c(n(U),{modelValue:C.value,"onUpdate:modelValue":a[0]||(a[0]=e=>C.value=e),placeholder:"Contraseña",class:"w-1/2"},null,8,["modelValue"]),F.value?(o(),m(n(V),{key:0,severity:"error",size:"small",variant:"simple"},{default:u(()=>[g(" * "+x(F.value),1)]),_:1})):v("",!0)]),d("div",Y,[c(n(B),{severity:"primary",label:"Verificar",class:"w-1/2",onClick:G})])]))],64))}};export{pe as default};
